# Node.js 热加载

> 本文通过 nodejs 自身缓存机制实现项目文件热加载

***
> nodejs 中所有文件都以 `commonJS` 模块机制被 `require` 到 `__cache` 中，可以打印 `require.cache` 看看有啥结果 <br />
> `require.cache['文件绝对路径']` 中存放着 js 文件的缓存，第一次加载之后将不再重新加载, <br /> 
> 所以如果你重复`require`一个文件并不会影响程序性能

***

> 可以利用 `delete require.cache['文件绝对路径']` 的方法删除文件缓存，之后 `require` 将重新加载文件到内存中，此时就实现了热加载 <br />
> 但是每个模块都有引用他的父文件(除了入口文件),所以必须告诉他的父文件，子文件都发生了变化，父文件自己也要进行重新加载缓存 <br />
> 这个过程简单描述就是子模块都进行 `delete require.cache['子文件路径']` ,然后告诉父文件，也执行 `delete require.cache['父文件路径']` <br />
> but,需要注意的是，一个子模块的父模块也有可能是有父模块，所以这是个递归的过程，直到找不到父模块为止。<br />
> 具体实现方法参考代码即可。

***

> 注意了，既然是热重载，就要保证程序的稳定性，所以不能让入口文件进行热重载，例如 `cluster.js` 或者 `app.js`